
\section{フーリエ変換による周波数解析}
スカラーの時間波形\(x(t)\)に対して頻繁に用いられるフーリエ変換について述べる。
\(t\)が連続量である時\(x(t)\)をアナログ信号と呼び、離散的であればディジタル信号と呼ぶ。
このセクションではアナログ信号とディジタル信号が混在するため、
アナログ信号に関しては\(x(t)\)と表記し、ディジタル信号を\(x_n\)と表記することで明確に区別する。
\subsection{4種類のフーリエ変換}
時間を連続的に扱うか離散的に扱うかの違いだけでなく、
周波数を連続的に扱うか否かによってもフーリエ変換の式は異なっており、\(2\times 2 = 4\)つのフーリエ変換がある。
通常はフーリエ変換について議論する場合は時間も周波数も連続であるとみなした式を使う場合が多いが、
コンピュータ上で数値の処理を行う場合は原則離散的であるため、4つのフーリエ変換について全て簡単に説明する。

\subsubsection{フーリエ変換}
スカラーの時間波形\(x(t)\)に対して、フーリエ変換は以下の(\ref{eq:FT})で表され、
逆フーリエ変換の式は(\ref{eq:iFT})で表される。
\begin{equation}
    X(\Omega)=\int_{-\infty}^{\infty} x(t)\exp(-i\Omega t)dt
    \label{eq:FT}
\end{equation}
\begin{equation}
    x(t)=\frac{1}{2\pi} \int_{-\infty}^{\infty} X(\Omega)\exp(i\Omega t)d\Omega
    \label{eq:iFT}
\end{equation}
ここで、\(i\)は虚数単位であり\(X(\Omega\))は\(\Omega\)を変数とするスカラー関数である。
逆フーリエ変換はスカラーの時間波形\(x(t)\)をある周波数\(\Omega\)の波形\(\exp(i\Omega t)\)の
線型結合によって表現した式である。このときの結合係数が\(X(\Omega)\)である。
工学的な立場では時間波形\(x(t)\)が与えられた時に、波形\(\exp(i\Omega t)\)による線形結合をすることで、
波形にどのような周波数の波形がどれくらいの割合で含まれているかを知りたいケースがある。
それを可能にするのがフーリエ変換であり、\(x(t)\)から結合係数\(X(\Omega)\)を算出することが可能である。
通常はこの時の結合係数\(X(\Omega)\)を周波数スペクトルと呼ぶ。
逆フーリエ変換(\ref{eq:iFT})に登場する定数倍\(1/2\pi\)は、フーリエ変換\(\cal F(\cdot)\)と逆フーリエ変換\({\cal F}^{-1}(\cdot)\)が、
フーリエ変換可能な時間波形\(x(t)\)に対して
\({\cal F}^{-1}({\cal F}(x(t))) = x(t)\)となるように調整するための係数である。
この係数は逆フーリエ変換の式ではなくフーリエ変換の式に付いていてもよく、あるいは両方の式に平方根の形で分配されていても構わない。
またフーリエ変換可能な時間波形とは以下を満たす\(x(t)\)である
\begin{equation}
    \int_{-\infty}^{\infty}|x(t)|dt < \infty
\end{equation}

\subsubsection{離散周波数フーリエ変換}
取りうる周波数を離散的にした場合のフーリエ変換について説明する。
離散周波数フーリエ変換という命名は便宜的にこの論文内で行っているものであり一般的ではない。
通常、ここで紹介するフーリエ変換は「フーリエ級数展開」として知られている。
歴史的には微分方程式を解くために開発され、フーリエ変換よりも先に発見されている。
離散周波数フーリエ変換と離散周波数逆フーリエ変換はそれぞれ(\ref{eq:sFT})と(\ref{eq:siFT})で表される。
\begin{equation}
    X_k=\frac{1}{T_0}\int_{-\frac{T_0}{2}}^{\frac{T_0}{2}} x(t)\exp(-i\Omega_0 kt)dt
    \label{eq:sFT}
\end{equation}
\begin{equation}
    x(t)=\sum_{k=-\infty}^{\infty} X_k \exp(i\Omega_0 k t)
    \label{eq:siFT}
\end{equation}
離散周波数逆フーリエ変換は、スカラーの時間波形\(x(t)\)を離散的な周波数\(\Omega_0 k\)の波形\(\exp(i\Omega_0 k t)\)の
結合係数によって表現した式である。このときの結合係数が\(X_k\)である。
ここに\(T_0\)は時間波形の周期であり、\(\Omega_0 = 2\pi/T_0\)を基本周波数と呼ぶ。
離散周波数フーリエ変換が、時間波形が与えられた時の周波数スペクトルを算出する役割を担うことは、フーリエ変換と同様である。
フーリエ変換との最たる違いは、時間波形に対して周期性を仮定している点であり、その周期は既知でなければならない。
時間波形が周期性を持つ場合には周波数は離散的な値を取るが、これはフーリエ変換対の間に一般的に成り立つ法則である。
すなわち変換対の一方が離散的である場合、他方は周期的となる。

\subsubsection{離散時間フーリエ変換}
取りうる時間を離散的にした場合のフーリエ変換について説明する。
離散時間フーリエ変換と離散時間逆フーリエ変換はそれぞれ(\ref{eq:tFT})と(\ref{eq:tiFT})で表される。
\begin{equation}
    X(\omega)=\sum_{n = -\infty}^{\infty} x_n \exp(-i\omega n)
    \label{eq:tFT}
\end{equation}
\begin{equation}
    x_n=\frac{1}{2\pi} \int_{-\pi}^{\pi} X(\omega) \exp(i\omega n)d\omega
    \label{eq:tiFT}
\end{equation}
離散時間逆フーリエ変換が、時間波形\(x_n\)を周波数スペクトル\(X(\omega)\)を結合係数とした
\(\exp(i\omega n)\)の線型結合を表しているのはこれまでと同様である。
しかし、離散時間フーリエ変換では周波数スペクトル\(X(\omega)\)が周期的な関数となることは
強調しておかねばならない。

\subsubsection{離散フーリエ変換}
離散フーリエ変換は、取りうる時間も周波数も離散的であるとした場合のフーリエ変換である。
コンピュータ上では原則的に全ての数値が離散的に扱われるため、時間も周波数も基本的には離散的であり、
高速フーリエ変換のアルゴリズムが実行する計算も離散フーリエ変換のことである。
離散フーリエ変換と離散逆フーリエ変換はそれぞれ(\ref{eq:tsFT})と(\ref{eq:tsiFT})で表される。
\begin{equation}
    X_k=\sum_{n = 0}^{N-1} x_n \exp \left(-i\frac{2\pi}{N} k n \right)
    \label{eq:tsFT}
\end{equation}
\begin{equation}
    x_n=\frac{1}{N}\sum_{k=0}^{N-1} X_k \exp \left(i \frac{2\pi}{N} k n \right)
    \label{eq:tsiFT}
\end{equation}
ここで\(N\)は周期である。ただし、サンプル時間点数の意味である。
時間波形に対する周期は\(N\)であるが、周波数スペクトルに対する周期も\(N\)となる。
仮に1周期が1000点のサンプル点によって構成される時間波形に対し離散フーリエ変換を用いた場合は、
得られる周波数スペクトルは1000点で周期を有する形式となる。
高速フーリエ変換と呼ばれる実応用で頻繁に用いられるアルゴリズムは、
(\ref{eq:tsFT})を高速に実行する処理である。

\subsection{周波数スペクトル}
ここでは時間波形\(x_n\)を人工的に生成し、
高速フーリエ変換によって(\ref{eq:tsFT})の計算を実行した場合にどのような違いが見られるかを確認する。


この手法の主な流れを記す。まず脳波信号を\(x(t) \in \mathbb{R}^D\)と表記する。ここに、\(D\)は電極の個数である。
まず電極に対しての重み付けベクトル(空間フィルタ)である$w \in \mathbb{R}^D$を何らかの方法で決定することで、
\begin{equation}
    z(t) = w^T x(t) \in \mathbb{R}    
\end{equation}
とスカラー値の時間波形に変換する。空間フィルタとしては着目したい頭皮領域に対して``スモールラプラシアンフィルタ''のような
決定論的な手法を用いる場合もあれば、PCAやICA、また次節で述べるCommon Spatial Pattern(CSP)のような統計的な指標に基づいた手法を用いる場合もある。
次に$z(t)$に対してフーリエ変換${\cal F}(\cdot)$を行い、スペクトル
\begin{equation}
    A(f) = {\cal F}(z(t))
\end{equation}
を獲得する。運動想起が行われた場合には特定の周波数において、パワースペクトル\(A(f)^2\)の減少が生じると期待できる。

\subsection{スペクトログラム}
フーリエ変換の代わりに$z(t)$に対して短時間フーリエ変換${\cal STFT}(\cdot)$を行い、
\begin{equation}
    A(t,f) = {\cal STFT}(z(t))
\end{equation}
を獲得し、スペクトログラムを特徴量として用いることもできる。
運動想起開始から事象関連脱同期がどのタイミングでどのくらいの長さ継続するのかも反映することができる。
あるいはウェーブレット変換などの他の時間周波数解析を用いることも可能である。