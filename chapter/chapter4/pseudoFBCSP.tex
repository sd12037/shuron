\section{\rm EEG\mc のためのニューラルネットワーク(提案手法)}
\subsection{\rm Convlution層によるFIR フィルタバンク}
EEGを\(X\in \mathbb R^{M\times N\times 1}\)とする。
ここに、\(M\)は電極の数、\(N\)はサンプル点数、\(1\)は後に周波数を示すためのダミーインデックスである。
\(X\)に対するConvolution層による演算は以下で表される。
\begin{equation}
    u_{m,n,k} = \sum_{c=1}^C\sum_{p=0}^{P-1}\sum_{q=0}^{Q-1} x_{m+p,n+q,c} h_{p,q,c,k} + b_{m,n,k}
\end{equation} 
この演算に関して、\(P=1,b_{m,n,k}=0,C=1\)でパラメータを与えることにより、
\begin{equation}
    u_{m,n,k} = \sum_{q=0}^{Q-1} x_{m,n+q,1} h_{1,q,1,k}
    \label{eq:pseudoFIR}
\end{equation} 
という演算を行うことができる。
ここでパラメータ\(H\in \mathbb R^{1\times D\times 1\times K}\)と与えることで、
フィルタ次数\(Q-1\)のFIRフィルタ\(K\)個からなるフィルタバンクとなる。
続いて、第2層について\(Q=1\)でパラメータを与えることにより
\begin{equation}
    v_{m,n,l} = \sum_{p=0}^{P-1} u_{m+p,n,k} g_{1,q,1,k}
    \label{eq:pseudoFIR}
\end{equation} 
という演算を行うことが可能であり、EEGに対して電極の重み付けを行っていることに相当する。
ここで\(g\)がパラメータである。

以降ニューラルネットワークの演算を適宜定義することで、
2層目以降の層は、EEGを入力としたフィルタバンクからの出力を受け取る。
FBCSPと異なる点は、FBCSPがフィルタバンクの設計とそれ以降の処理の設計が完全に分断されていることに対し、
提案手法ではフィルタバンクのフィルタ係数と、その後の処理に用いられるパラメータを
同時に最適化可能な点である。


\section{\rm 高階テンソルとしてのEEG\mc データ構造}
通常、EEGのデータは時間の次元を持つサンプル点数と空間的な情報を有する電極をインデックスとした
2階テンソルとして表現されるが、本論文では運動想起時のEEGは時間、電極、周波数をインデックスとした
高階テンソルで表されると仮定する。
この仮定はEEG従来より周波数帯域毎に異なる脳波として捉えられてきたこと、
特定の身体部位に対応する脳の領域が局所的であること、時系列データであることから妥当であると考えられる。

また電極のインデックスについては任意の配置によってテンソル化がなされるが、
頭皮上の空間的配置によって電極間の関連性は異なっている。
したがって時間、電極、周波数のインデックスに関して
電極のインデックスの取り方を2次元に展開し
時間、頭皮上の座標1、頭皮上の座標2、周波数をインデックスとする4階テンソルとして捉え直す。

この場合におけるEEGの測定データは
EEGが\(X\in \mathbb R^{M_1\times M_2\times N\times 1}\)と与えられ、
Convlution層を用いたFIRフィルタバンクは、3DConvlution層を用いることで以下の式で書き換えられる。
\begin{eqnarray}
    u_{m_1,m_2,n,k}& = &\sum_{c=1}^C\sum_{p_1=0}^{P_1-1}\sum_{p_2=0}^{P_2-1}\sum_{q=0}^{Q-1} x_{m_1+p_1,m_2+p_2,n+q,c} h_{p_1,p_2,q,c,k} + b_{m_1,m_2,n,k}\\
    u_{m_1,m_2,n,k}& = &\sum_{q=0}^{Q-1} x_{m_1,m_2,n+q,1} h_{1,1,q,1,k}
    \label{eq:pseudoFIR3D}
\end{eqnarray} 
\(u_{m_1,m_2,n,k}\)について\(m_1,m_2\)が頭皮上の座標を表すインデックスである。
この\(4\)階テンソルを適切に処理する構造を更に構築することで、End to EndのBCI構築を可能とする。


\subsection{\mc 関連研究}
\subsubsection{\rm Shallow FBCSP}
〜らの\cite{ShallowFBCSP}では、Convolution層を1層目に用いる際に
時間方向にのみ畳み込みを行うことを提案しており、
フィルタバンクを構成しているとみなせる。〜らはその後電極方向の畳み込みを行い、
Spartial Patternを抽出していると主張しており、論文内でのニューラルネットワークを
ShallowFBCSPと名づけている。
